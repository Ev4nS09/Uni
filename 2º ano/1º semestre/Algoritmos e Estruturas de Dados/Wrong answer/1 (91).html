<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Report of submission 02177808_C_Afonso_Silva_76943</title>
<link
rel	="stylesheet"
href	="../../styles/base.css"
type	="text/css">
</head>
<body>
<h2>Report #1</h2>

<table>
<tr>
<th>Submission</th>
<td>
<a href="?inspect+data/contests/AED22P4/submissions/02177808_C_Afonso_Silva_76943">02177808_C_Afonso_Silva_76943</a>
</td>
</tr>
<tr>
<th>File</th>
<td>
<a href="?inspect+data/contests/AED22P4/submissions/02177808_C_Afonso_Silva_76943/TwualgerC.java">TwualgerC.java</a>
<a href="data/contests/AED22P4/submissions/02177808_C_Afonso_Silva_76943/TwualgerC.java">[Download]</a>
</td>

<tr><th>Received</td>	<td>Fri Dec 02 17:34:48 +0000 2022</td></tr>
<tr><th>Analyzed</td>	<td>Fri Dec 02 17:34:48 +0000 2022 (0:00:00)</td></tr><tr>
<th>Team</th>
<td>
<a href="?inspect+data/contests/AED22P4/groups/students/Afonso_Silva_76943">
Afonso_Silva_76943
</a> Login: <code>Afonso_Silva_76943</code> Group: students [students]
</td><tr>
<th>Language</th>
<td>
<a href="?inspect+data/contests/AED22P4/languages/Java">
Java
</a>
</td><tr>
<th>Problem</th>
<td>
<a href="?inspect+data/contests/AED22P4/problems/C">
C: TwualgerC
</a>
</td><tr>
<th>Compilation</th>
<td></td>
</tr>
</table><p>
<table
border="1"
width="100%">
<tr>
<th>Test</th>
<th>Expected</th>
<th>Obtained</th>
<th>Differences</th>
</tr><tr>
<td valign="top">
<a href="?inspect+/home/dshak/data/contests/AED22P4/problems/C/tests/testC01">
testC01
</a><br>
T=0.341 sec<br>
E=0 sec<br>
M=184172 Kb<br>
<br>
</td>
<td valign="top"><pre><font color="orange"><i>Output demasiado longo: truncado</i></font>
TEST INFO: testing readTweetsFromFile
elonmusk: count 0, tweets in cache 15, moreInFile? true
2022-07-11T21:07:18Z, elonmusk:b'@BillyM2k Mimic + Dark Moon + Stars of Ruin'
2022-07-11T20:51:22Z, elonmusk:b'https://t.co/mvVUR4doqB'
Oldest: 2022-07-11T04:04Z, elonmusk:b'https://t.co/JcLMee61wj'
elonmusk: count 0, tweets in cache 999, moreInFile? false
Newest:2022-07-11T21:07:18Z, elonmusk:b'@BillyM2k Mimic + Dark Moon + Stars of Ruin'
Oldest:2022-05-03T15:39:55Z, elonmusk:"b'@Kristennetten They will...</pre></td>
<td valign="top"><pre><font color="orange"><i>Output demasiado longo: truncado</i></font>
TEST INFO: testing readTweetsFromFile
elonmusk: count 0, tweets in cache 15, moreInFile? true
2022-07-11T21:07:18Z, elonmusk:b'@BillyM2k Mimic + Dark Moon + Stars of Ruin'
2022-07-11T20:51:22Z, elonmusk:b'https://t.co/mvVUR4doqB'
Oldest: 2022-07-11T04:04Z, elonmusk:b'https://t.co/JcLMee61wj'
elonmusk: count 0, tweets in cache 999, moreInFile? false
Newest:2022-07-11T21:07:18Z, elonmusk:b'@BillyM2k Mimic + Dark Moon + Stars of Ruin'
Oldest:2022-05-03T15:39:55Z, elonmusk:"b'@Kristennetten They will...</pre></td>
<td valign="top"><pre></pre></td>
</tr><tr>
<td valign="top">
<a href="?inspect+/home/dshak/data/contests/AED22P4/problems/C/tests/testC02">
testC02
</a><br>
T=0.410 sec<br>
E=0 sec<br>
M=187880 Kb<br>
<font color="red">Wrong Answer</font><br>
</td>
<td valign="top"><pre><font color="orange"><i>Output demasiado longo: truncado</i></font>
TEST INFO: testing updateUserCacheFromFile
elonmusk: count 0, tweets in cache 15, moreInFile? true
Newest:2022-07-11T21:07:18Z, elonmusk:b'@BillyM2k Mimic + Dark Moon + Stars of Ruin'
Oldest:2022-07-11T04:04Z, elonmusk:b'https://t.co/JcLMee61wj'
elonmusk: count 0, tweets in cache 15, moreInFile? true
Newest:2022-07-11T21:07:18Z, elonmusk:b'@BillyM2k Mimic + Dark Moon + Stars of Ruin'
Oldest:2022-07-11T04:04Z, elonmusk:b'https://t.co/JcLMee61wj'
elonmusk: count 0, tweets in cache 276, moreInFile? ...</pre></td>
<td valign="top"><pre><font color="orange"><i>Output demasiado longo: truncado</i></font>
TEST INFO: testing updateUserCacheFromFile
elonmusk: count 0, tweets in cache 15, moreInFile? true
Newest:2022-07-11T21:07:18Z, elonmusk:b'@BillyM2k Mimic + Dark Moon + Stars of Ruin'
Oldest:2022-07-11T04:04Z, elonmusk:b'https://t.co/JcLMee61wj'
elonmusk: count 0, tweets in cache 15, moreInFile? true
Newest:2022-07-11T21:07:18Z, elonmusk:b'@BillyM2k Mimic + Dark Moon + Stars of Ruin'
Oldest:2022-07-11T04:04Z, elonmusk:b'https://t.co/JcLMee61wj'
elonmusk: count 0, tweets in cache 276, moreInFile? ...</pre></td>
<td valign="top"><pre>11c11
< elonmusk: count 0, tweets in cache 999, moreInFile? false
---
> elonmusk: count 0, tweets in cache 999, moreInFile? true
14c14
< elonmusk: count 0, tweets in cache 999, moreInFile? false
---
> elonmusk: count 0, tweets in cache 999, moreInFile? true
</pre></td>
</tr><tr>
<td valign="top">
<a href="?inspect+/home/dshak/data/contests/AED22P4/problems/C/tests/testC03">
testC03
</a><br>
T=1.002 sec<br>
E=1 sec<br>
M=192720 Kb<br>
<br>
</td>
<td valign="top"><pre><font color="orange"><i>Output demasiado longo: truncado</i></font>
TEST INFO: testing constructor & getUserCache
Total caches: 32
mileycyrus(TOP): count 2, tweets in cache 0, moreInFile? true
benzema: count 1, tweets in cache 7, moreInFile? true
Newest:2022-07-11T13:42:25Z, benzema:b'Nueve /// Gucci\n@adidasoriginals \xe2\x9a\x9...
Oldest:2022-07-09T10:22:11Z, benzema:b'Aid Mubarak \xc3\xa0 tous \xf0\x9f\xa4\xb2\xf...
Total caches: 33
Two searches retrieve the same cache object: true
mileycyrus(TOP): count 4, tweets in cache 0, moreInFile? true
jlo(TOP): count 1...</pre></td>
<td valign="top"><pre><font color="orange"><i>Output demasiado longo: truncado</i></font>
TEST INFO: testing constructor & getUserCache
Total caches: 32
mileycyrus(TOP): count 2, tweets in cache 0, moreInFile? true
benzema: count 1, tweets in cache 7, moreInFile? true
Newest:2022-07-11T13:42:25Z, benzema:b'Nueve /// Gucci\n@adidasoriginals \xe2\x9a\x9...
Oldest:2022-07-09T10:22:11Z, benzema:b'Aid Mubarak \xc3\xa0 tous \xf0\x9f\xa4\xb2\xf...
Total caches: 33
Two searches retrieve the same cache object: true
mileycyrus(TOP): count 4, tweets in cache 0, moreInFile? true
jlo(TOP): count 1...</pre></td>
<td valign="top"><pre></pre></td>
</tr><tr>
<td valign="top">
<a href="?inspect+/home/dshak/data/contests/AED22P4/problems/C/tests/testC04">
testC04
</a><br>
T=0.466 sec<br>
E=0 sec<br>
M=189800 Kb<br>
<font color="red">Wrong Answer</font><br>
</td>
<td valign="top"><pre><font color="orange"><i>Output demasiado longo: truncado</i></font>
TEST INFO: testing buildTimeLine
Invalid Timeline
Total tweets retrieved: 0
Timeline with 72 hours
Total tweets retrieved: 10
2022-07-09T03:30:04Z, akshaykumar:b'Deeply pained at the loss of lives at Baltal ...
2022-07-09T16:26:37Z, shakira:b'Nos ense\xc3\xb1aste a levantarnos despu\xc3\...
2022-07-09T18:53:36Z, billgates:"b'If you\xe2\x80\x99re a big tennis fan like I...
TEST INFO: Timeline with 1 month
Total tweets retrieved: 262
2022-06-12T13:51:01Z, shakira:b'Me acaba de contar mi equipo que ...</pre></td>
<td valign="top"><pre><font color="orange"><i>Output demasiado longo: truncado</i></font>
TEST INFO: testing buildTimeLine
Invalid Timeline
2022-07-11T07:00:05Z
2022-07-09T18:53:36Z
2022-07-11T21:10:50Z
2022-07-09T16:26:37Z
2022-07-11T14:27:35Z
2022-07-10T14:47:29Z
2022-07-11T16:05:25Z
2022-07-10T19:29:20Z
2022-07-09T03:30:04Z
2022-07-11T05:25:44Z
Total tweets retrieved: 0
Timeline with 72 hours
2022-07-11T07:00:05Z
2022-07-09T18:53:36Z
2022-07-11T21:10:50Z
2022-07-09T16:26:37Z
2022-07-11T14:27:35Z
2022-07-10T14:47:29Z
2022-07-11T16:05:25Z
2022-07-10T19:29:20Z
2022-07-09T03:30:04Z
202...</pre></td>
<td valign="top"><pre><font color="orange"><i>Output demasiado longo: truncado</i></font>
2a3,12
> 2022-07-11T07:00:05Z
> 2022-07-09T18:53:36Z
> 2022-07-11T21:10:50Z
> 2022-07-09T16:26:37Z
> 2022-07-11T14:27:35Z
> 2022-07-10T14:47:29Z
> 2022-07-11T16:05:25Z
> 2022-07-10T19:29:20Z
> 2022-07-09T03:30:04Z
> 2022-07-11T05:25:44Z
4a15,24
> 2022-07-11T07:00:05Z
> 2022-07-09T18:53:36Z
> 2022-07-11T21:10:50Z
> 2022-07-09T16:26:37Z
> 2022-07-11T14:27:35Z
> 2022-07-10T14:47:29Z
> 2022-07-11T16:05:25Z
> 2022-07-10T19:29:20Z
> 2022-07-09T03:30:04Z
> 2022-07-11T05:25:44Z
10c30,243
< Total tweets r...</pre></td>
</tr><tr>
<td valign="top">
<a href="?inspect+/home/dshak/data/contests/AED22P4/problems/C/tests/testC05">
testC05
</a><br>
T=3.427 sec<br>
E=3 sec<br>
M=190356 Kb<br>
<font color="red">Wrong Answer</font><br>
</td>
<td valign="top"><pre><font color="orange"><i>Output demasiado longo: truncado</i></font>
TEST INFO: testing Twualger general functionality and efficiency
TEST INFO: Timeline 1Week
Total tweets retrieved: 37
2022-07-11T21:10:50Z, billgates:b'Fusion will need to be an important part of o...
2022-07-11T16:05:25Z, kimkardashian:"b'Here\xe2\x80\x99s an exclusive first look at...
Total tweets retrieved: 4580
TEST INFO: printing older tweets
2022-01-12T03:37:55Z, jimmyfallon:b'RT @FallonTonight: A deal\xe2\x80\x99s a deal...
2022-01-12T05:57:20Z, imraina:b'Happy birthday @vikrantgupta73 Paj...</pre></td>
<td valign="top"><pre><font color="orange"><i>Output demasiado longo: truncado</i></font>
TEST INFO: testing Twualger general functionality and efficiency
TEST INFO: Timeline 1Week
2022-07-07T21:33:58Z
2022-07-08T18:01:19Z
2022-07-09T18:53:36Z
2022-07-11T21:10:50Z
2022-07-05T20:32:18Z
2022-07-11T07:00:05Z
2022-07-06T14:04:31Z
2022-07-06T14:05:18Z
2022-07-06T14:06:43Z
2022-07-06T14:07:01Z
2022-07-06T14:07:43Z
2022-07-06T16:00:42Z
2022-07-07T14:00:45Z
2022-07-07T14:00:46Z
2022-07-07T14:00:48Z
2022-07-07T22:52:18Z
2022-07-07T22:52:20Z
2022-07-07T22:52:27Z
2022-07-08T01:07:06Z
2022-07-08T...</pre></td>
<td valign="top"><pre><font color="orange"><i>Output demasiado longo: truncado</i></font>
3c3,37
< Total tweets retrieved: 37
---
> 2022-07-07T21:33:58Z
> 2022-07-08T18:01:19Z
> 2022-07-09T18:53:36Z
> 2022-07-11T21:10:50Z
> 2022-07-05T20:32:18Z
> 2022-07-11T07:00:05Z
> 2022-07-06T14:04:31Z
> 2022-07-06T14:05:18Z
> 2022-07-06T14:06:43Z
> 2022-07-06T14:07:01Z
> 2022-07-06T14:07:43Z
> 2022-07-06T16:00:42Z
> 2022-07-07T14:00:45Z
> 2022-07-07T14:00:46Z
> 2022-07-07T14:00:48Z
> 2022-07-07T22:52:18Z
> 2022-07-07T22:52:20Z
> 2022-07-07T22:52:27Z
> 2022-07-08T01:07:06Z
> 2022-07-08T01:07:32Z
>...</pre></td>
</tr><tr>
<td valign="top">
<a href="?inspect+/home/dshak/data/contests/AED22P4/problems/C/tests/testC06">
testC06
</a><br>
T=0.856 sec<br>
E=0 sec<br>
M=190340 Kb<br>
<font color="red">Wrong Answer</font><br>
</td>
<td valign="top"><pre><font color="orange"><i>Output demasiado longo: truncado</i></font>
TEST INFO: testing downsizeCache
Total searches: 156
Hit ratio:0.6858974
Total caches: 81
adamlambert: count 1, tweets in cache 0, moreInFile? true
1loganhenderson: count 2, tweets in cache 50, moreInFile? true
Newest:2022-06-30T13:49:59Z, 1loganhenderson:b'\xe2\x80\x9cHONEY\xe2\x80\x9d out now!\n\nhtt...
Oldest:2021-07-19T16:39:30Z, 1loganhenderson:"b'RT @bigtimerush: WE ARE BACK! It\xe2\x80\x99...
elonmusk(TOP): count 3, tweets in cache 999, moreInFile? false
Newest:2022-07-11T21:07:18Z, elonmu...</pre></td>
<td valign="top"><pre><font color="orange"><i>Output demasiado longo: truncado</i></font>
TEST INFO: testing downsizeCache
2022-07-09T18:53:36Z
2022-07-11T21:10:50Z
2022-07-11T07:00:05Z
2022-07-10T14:47:29Z
2022-07-11T16:05:25Z
2022-07-09T03:30:04Z
2022-07-11T05:25:44Z
2022-06-15T00:10:51Z
2022-06-16T22:44:59Z
2022-06-18T21:45:46Z
2022-06-20T00:40:45Z
2022-06-20T00:42:28Z
2022-06-21T19:23:20Z
2022-06-23T01:49:21Z
2022-06-24T14:35:01Z
2022-06-24T14:35:04Z
2022-06-24T14:35:07Z
2022-06-24T19:33:57Z
2022-06-24T19:34:15Z
2022-06-24T19:34:21Z
2022-06-27T19:45:33Z
2022-06-28T22:18:39Z
2022-0...</pre></td>
<td valign="top"><pre><font color="orange"><i>Output demasiado longo: truncado</i></font>
1a2,16910
> 2022-07-09T18:53:36Z
> 2022-07-11T21:10:50Z
> 2022-07-11T07:00:05Z
> 2022-07-10T14:47:29Z
> 2022-07-11T16:05:25Z
> 2022-07-09T03:30:04Z
> 2022-07-11T05:25:44Z
> 2022-06-15T00:10:51Z
> 2022-06-16T22:44:59Z
> 2022-06-18T21:45:46Z
> 2022-06-20T00:40:45Z
> 2022-06-20T00:42:28Z
> 2022-06-21T19:23:20Z
> 2022-06-23T01:49:21Z
> 2022-06-24T14:35:01Z
> 2022-06-24T14:35:04Z
> 2022-06-24T14:35:07Z
> 2022-06-24T19:33:57Z
> 2022-06-24T19:34:15Z
> 2022-06-24T19:34:21Z
> 2022-06-27T19:45:33Z
> 2022-0...</pre></td>
</tr></table>
<p><table>
<tr>	<th>CPU	  </th><td>3.427 (3) sec</td>	</tr>
<tr>	<th>Memory	  </th><td>192720 kbytes</td>			</tr>
<tr>	<th>Classification</th><td>Wrong Answer</td>		</tr>
<tr>	<th>Mark</th>	  <td>2</td>		</tr>
<tr>
<th valign="top">Observations</th>
<td><pre></pre></td>
</tr>
<tr>
<th valign="top">Feedback</th>
<td><pre></pre></td>
</tr>

<tr>
<th>Code</th>
<td></td>
</table>
<pre>
package aed.twualger;

import aed.tables.Treap;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.time.OffsetDateTime;
import java.time.ZoneOffset;
import java.time.format.DateTimeFormatter;
import java.util.*;

public class TwualgerC extends Twualger {

    //ideally we would use current datetime, but we only have tweet data until Jully 11th
    private static final OffsetDateTime CURRENT_DATE = OffsetDateTime.of(2022,07,11,23,59,59,0,ZoneOffset.UTC);
    private static final OffsetDateTime CURRENT_MINUS_72H = CURRENT_DATE.minusHours(72);

    HashMap&lt;String,UserCacheB&gt; cache;
    private int hit = 0;
    private int miss = 0;

    public TwualgerC(String path)
    {
        super(path);
        this.cache = new  HashMap&lt;String, UserCacheB&gt;();
        List&lt;String&gt; topCelebs = Twualger.readTopCelebs(path);
        for (int i = 0; i &lt; topCelebs.size(); i++) {
            UserCacheB userCacheB = readUserTweetsFromFile(path, topCelebs.get(i), CURRENT_MINUS_72H);
            userCacheB.isTop = true;
            // result.useCount++;
            this.cache.put(topCelebs.get(i), userCacheB);
        }
    }
	
	public List&lt;UserCacheB&gt; getCaches()
    {
        return new ArrayList&lt;UserCacheB&gt;(this.cache.values());
    }


    public static UserCacheB readUserTweetsFromFile(String path, String userHandle, OffsetDateTime oldest)
    {
        @SuppressWarnings("unchecked")
        Treap&lt;OffsetDateTime, Tweet&gt; tweets = new Treap();
        UserCacheB result = new UserCacheB(userHandle);
        try 
        {
            File file = new File(path + "/" + userHandle + ".csv");
            FileReader fr = new FileReader(file);
            BufferedReader br = new BufferedReader(fr);
            String line = br.readLine();
            String[] tweetSplit;
            while ((line = br.readLine()) != null) {
                tweetSplit = line.split(",", 3);
                Tweet tweet = new Tweet(Long.parseLong(tweetSplit[0]), OffsetDateTime.parse(tweetSplit[1], DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm:ssZZZZZ")), userHandle, tweetSplit[2]);
                if(tweet.date.compareTo(oldest) &lt; 0){
                    result.moreTweetsInFile = true;
                    break;
                }
                tweets.put(tweet.date, tweet);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
        result.tweets = tweets;
        return result;
    }

    public static void updateUserCacheFromFile(UserCacheB userCache, String path, String userHandle, OffsetDateTime oldest)
    {
        try 
        {
            File file = new File(path + "/" + userHandle + ".csv");
            FileReader fr = new FileReader(file);
            BufferedReader br = new BufferedReader(fr);
            String[] tweetSplit;
            OffsetDateTime oldestCacheDate = userCache.tweets.min();
            String line = br.readLine();
            while ((line = br.readLine()) != null) {
                tweetSplit = line.split(",", 3);
                Tweet tweet = new Tweet(Long.parseLong(tweetSplit[0]), OffsetDateTime.parse(tweetSplit[1], DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm:ssZZZZZ")), userHandle, tweetSplit[2]);
                if(tweet.date.compareTo(oldest) &gt;= 0 &amp;&amp; tweet.date.compareTo(oldestCacheDate) &lt;= 0){
                    userCache.tweets.put(tweet.date, tweet);
                }
                else if(tweet.date.compareTo(oldest) &lt; 0){
                    userCache.moreTweetsInFile = true;
                    break;
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public UserCacheB getUserCache(String userHandle)
    {
        UserCacheB result = this.cache.get(userHandle);
        if (result != null) {
            hit++;
            result.useCount++;
        }
        else{
            result = readUserTweetsFromFile(path, userHandle, CURRENT_MINUS_72H);
            miss++;
            result.useCount++;
            this.cache.put(userHandle, result);
        }
        return result;
    }

    public List&lt;Tweet&gt; buildTimeLine(List&lt;String&gt; following, OffsetDateTime from, OffsetDateTime to)
    {
        List&lt;Tweet&gt; result = new ArrayList&lt;&gt;();
        UserCacheB followingCache;
        for (int i = 0; i &lt; following.size(); i++) {
            followingCache = getUserCache(following.get(i));
            if(followingCache.moreTweetsInFile == true &amp;&amp; followingCache.tweets.min() != null &amp;&amp; from.compareTo(followingCache.tweets.min()) &lt; 0) {
                updateUserCacheFromFile(followingCache, path, followingCache.userName, from);
                this.cache.replace(followingCache.userName, followingCache);
            }
            Iterable&lt;Tweet&gt; tweetIterable = followingCache.tweets.values();
            for (Tweet tweet : tweetIterable) {
                System.out.println(tweet.date);
                if (tweet.date.compareTo(from) &gt;= 0 &amp;&amp; tweet.date.compareTo(to) &lt;= 0) {
                    result.add(tweet);
                }
            }
        }
        result.sort((Tweet a, Tweet b) -&gt; b.date.compareTo(a.date));
        return result;
    }

    public int totalSearches() {
        return hit + miss;
    }

    public float cacheHitRatio() {
        return totalSearches() == 0 ? 0 : ((float) hit) / ((float) miss + (float) hit);
    }

    public void downsizeCache()
    {
        //TODO: implement
        return;
    }

    public static void main(String[] args)
    {
        String path = "C:\\Users\\afons\\OneDrive\\Documentos\\aed\\p4\\data";
        TwualgerC twualger = new TwualgerC(path);
        // updateUserCacheFromFile(this.cache.get(following.get(i)), path, followingCache.userName, to);
        // Iterable&lt;Tweet&gt; tweetIterable = twualger.cache.get("elonmusk").tweets.values();
        // twualger.updateUserCacheFromFile(twualger.cache.get("elonmusk"), path, "elonmusk",  OffsetDateTime.of(2022,07,07,14,26,00,00,ZoneOffset.UTC));
        ArrayList&lt;String&gt; following = new ArrayList&lt;String&gt;(Arrays.asList("elonmusk","RobertDowneyJr","Cristiano"));

        List&lt;Tweet&gt; tweets = twualger.buildTimeLine(
                following,
                OffsetDateTime.of(2022,4,1,0,0,0,0, ZoneOffset.UTC),
                OffsetDateTime.of(2022,4,29,23,59,0,0,ZoneOffset.UTC));

                

        printTweets(tweets);

    }

}

</pre>

</body>